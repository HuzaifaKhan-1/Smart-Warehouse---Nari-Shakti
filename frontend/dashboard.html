<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Command Center | AgriFresh Intelligence</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="blob"></div>
    <div class="blob-2"></div>

    <!-- Modals -->
    <div id="zoneModal" class="modal-overlay">
        <div class="modal-content glass-panel">
            <span class="close-modal" onclick="window.closeZoneModal()">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <aside class="sidebar">
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 50px; padding: 0 10px;">
            <div
                style="width: 40px; height: 40px; background: var(--primary); border-radius: 10px; transform: rotate(45deg); display: flex; align-items: center; justify-content: center;">
                <i class="fas fa-leaf" style="transform: rotate(-45deg); color: white;"></i>
            </div>
            <span style="font-size: 1.5rem; font-weight: 800; letter-spacing: -1px;">AgriFresh</span>
        </div>

        <nav>
            <a href="dashboard.html" class="nav-item active"><i class="fas fa-grid-2"></i> Dashboard</a>
            <a href="inventory.html" class="nav-item"><i class="fas fa-box-archive"></i> Inventory</a>
            <a href="analytics.html" class="nav-item"><i class="fas fa-analytics"></i> Analytics</a>
            <a href="trace.html" class="nav-item"><i class="fas fa-barcode-read"></i> Traceability</a>
        </nav>

        <!-- Farmer Side Panel -->
        <div class="farmer-panel" style="margin-top: auto;">
            <h4
                style="font-size:0.8rem; font-weight:800; color:var(--primary); margin-bottom:15px; text-transform:uppercase;">
                My Produce Health</h4>
            <div class="farmer-stat">
                <span style="font-size:0.85rem; color:var(--text-secondary);">Total Batches</span>
                <span style="font-weight:700;">8</span>
            </div>
            <div class="farmer-stat">
                <span style="font-size:0.85rem; color:var(--text-secondary);">Attention Needed</span>
                <span style="color:var(--danger); font-weight:700;">2</span>
            </div>
            <div style="margin-top:15px;">
                <p style="font-size:0.75rem; color:var(--text-secondary); line-height:1.4;">
                    <i class="fas fa-info-circle"></i> AI suggests dispatching <strong>Lot #AF-290</strong> within 2
                    days to maximize profit.
                </p>
            </div>
        </div>
    </aside>

    <main class="main-wrapper">
        <!-- AI Insight Bar -->
        <div class="ai-insight-bar" id="aiInsightBar">
            <!-- Dynamically via state.js -->
        </div>

        <section class="section-header">
            <div>
                <h1 style="font-size: 2.2rem; font-weight: 800; letter-spacing: -1px;">Command Center</h1>
                <p style="color: var(--text-secondary);">Connected: Nashik Central Hub (Live)</p>
            </div>
            <div style="display: flex; gap: 16px;">
                <button class="btn-premium" id="demoModeBtn"
                    style="background: linear-gradient(135deg, #f59e0b, #d97706); padding:12px 24px;">
                    <i class="fas fa-bolt"></i> Run Simulation
                </button>
                <div class="glass-panel"
                    style="width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                    <i class="fas fa-sync-alt"></i>
                </div>
            </div>
        </section>

        <!-- 1. Smart Summary Section -->
        <div class="metrics-grid">
            <div class="glass-panel metric-card" style="cursor:pointer;">
                <p class="metric-label">Loss Prevented</p>
                <div class="metric-value" id="lossPrevented">â‚¹0</div>
                <div style="font-size:0.8rem; color:var(--primary);"><i class="fas fa-arrow-up"></i> AI Optimization
                    Active</div>
            </div>
            <div class="glass-panel metric-card" style="cursor:pointer;">
                <p class="metric-label">Current Spoilage Risk</p>
                <div class="metric-value" id="atRiskCount" style="color:var(--danger);">0</div>
                <div style="font-size:0.8rem; color:var(--text-secondary);">High Risk Batches Detected</div>
            </div>
            <div class="glass-panel metric-card" style="cursor:pointer;">
                <p class="metric-label">Utilization Rate</p>
                <div class="metric-value" id="utilizationVal">0%</div>
                <div class="accuracy-bar" style="height:4px;">
                    <div class="accuracy-fill" id="utilFill" style="width: 78%"></div>
                </div>
            </div>
            <div class="glass-panel metric-card" style="cursor:pointer;">
                <p class="metric-label">Environment Health</p>
                <div class="metric-value" id="healthStatus" style="font-size:1.8rem; margin:15px 0;">Loading...</div>
                <div style="font-size:0.8rem; color:var(--text-secondary);">96% Spoilage Accuracy</div>
            </div>
        </div>

        <!-- 2. Interactive Heatmap Section -->
        <div class="glass-panel heatmap-container">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h3 style="font-weight: 800; font-size: 1.4rem;">Warehouse Intelligence Heatmap</h3>
                <div style="display: flex; gap: 15px; font-size: 0.75rem;">
                    <span style="display:flex; align-items:center; gap:5px"><i class="fas fa-circle"
                            style="color: var(--primary)"></i> Safe</span>
                    <span style="display:flex; align-items:center; gap:5px"><i class="fas fa-circle"
                            style="color: var(--accent)"></i> Warning</span>
                    <span style="display:flex; align-items:center; gap:5px"><i class="fas fa-circle"
                            style="color: var(--danger)"></i> Critical</span>
                </div>
            </div>
            <div class="heatmap-grid" id="heatmapGrid">
                <!-- JS Injected Tiles -->
            </div>
        </div>

        <!-- 3 & 4. AI Decision Center & Trends -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
            <div class="glass-panel" style="padding: 30px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:24px;">
                    <h3 style="font-weight: 800; font-size: 1.4rem;">AI Decision Center</h3>
                    <span style="font-size:0.7rem; font-weight:700; color:var(--text-secondary);">COMMANDS
                        PENDING</span>
                </div>
                <div id="aiDecisionCenter">
                    <!-- AI recommendation cards -->
                </div>
            </div>
            <div class="glass-panel" style="padding: 30px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:24px;">
                    <h3 style="font-weight: 800; font-size: 1.4rem;">Environmental Trend</h3>
                    <div style="display:flex; gap:10px;">
                        <span class="badge"
                            style="background:rgba(255,255,255,0.05); color:white; cursor:pointer;">24H</span>
                        <span class="badge"
                            style="background:transparent; color:var(--text-secondary); cursor:pointer;">7D</span>
                    </div>
                </div>
                <div class="chart-container" style="height:350px;">
                    <canvas id="envTrendChart"></canvas>
                </div>
                <div
                    style="margin-top:20px; padding:15px; background:rgba(16, 185, 129, 0.05); border-radius:12px; border:1px solid rgba(16, 185, 129, 0.1);">
                    <p style="font-size:0.85rem; color:var(--primary);">
                        <i class="fas fa-magic"></i> AI Insight: Temperature stability has increased yield by
                        <strong>12%</strong> this month.
                    </p>
                </div>
            </div>
        </div>
    </main>

    <script type="module" src="js/dashboard.js"></script>
</body>

</html>